import { Button, ProgressIndicator, LineEdit, ListView } from "std-widgets.slint";

export struct StatCard {
    title: string,
    value: string,
    subtitle: string,
}

export struct SubdomainRow {
    name: string,
    status: string,
    highlight: bool,
}

export struct ActivityBar {
    label: string,
    value: float,
}

export struct AlertRow {
    label: string,
    count: string,
    accent: brush,
}

export struct FeatureFeedbackRow {
    title: string,
    detail: string,
}

export component Dashboard inherits Window {
    width: 1024px;
    height: 640px;
    title: "ShadowMap Dashboard";
    background: @linear-gradient(200deg, #080b1d, #121735);

    in property <string> current-date;
    in property <string> current-time;
    in-out property <string> domain-input;
    in property <string> status-text;
    in property <brush> status-color;
    in property <bool> scan-in-progress;
    in property <string> last-run;
    in property <float> scan-progress;
    in property <[StatCard]> stats;
    in property <[SubdomainRow]> subdomains;
    in property <[ActivityBar]> activity;
    in property <[AlertRow]> alerts;
    in property <[FeatureFeedbackRow]> feature-feedback;
    in-out property <bool> report-available;

    callback start-scan(string);
    callback download-compliance-report();

    Rectangle {
        width: parent.width;
        height: parent.height;
        background: @radial-gradient(circle at 16% 12%, #5d7cff2e, #080b1d00);
        z: -1;
    }

    Rectangle {
        width: parent.width;
        height: parent.height;
        background: @radial-gradient(circle at 78% 8%, #43d3ff21, #080b1d00);
        z: -1;
    }

    Rectangle {
        width: parent.width;
        height: parent.height;
        padding: 32px;
        background: @linear-gradient(155deg, #111731aa, #0c1226a0);
        border-radius: 36px;
        border-width: 1px;
        border-color: #ffffff1a;
        drop-shadow-color: #050916a6;
        drop-shadow-blur: 48px;
        drop-shadow-offset: 0px;
        clip: true;
        z: 1;

        VerticalLayout {
            width: parent.width;
            height: parent.height;
            padding: 28px;
            spacing: 20px;
        HorizontalLayout {
            Text {
                text: root.current-date;
                font-size: 22px;
                color: #f2f4ff;
            }
            Rectangle {
                horizontal-stretch: 1;
                opacity: 0;
            }
            Text {
                text: root.current-time;
                font-size: 18px;
                color: #8ea0ff;
            }
        }

        Rectangle {
            background: @linear-gradient(130deg, #1f2646cc, #10162fd8);
            border-radius: 28px;
            border-width: 1px;
            border-color: #ffffff1a;
            padding: 26px;
            drop-shadow-color: #0307128f;
            drop-shadow-blur: 36px;
            drop-shadow-offset: 0px;
            clip: true;
            VerticalLayout {
                spacing: 14px;
                Rectangle {
                    horizontal-stretch: 1;
                    height: 2px;
                    border-radius: 2px;
                    background: @linear-gradient(90deg, #ffffff33, #ffffff05);
                    opacity: 0.6;
                }
                Text {
                    text: "Recon Orchestrator";
                    font-size: 26px;
                    color: #ffffff;
                }
                HorizontalLayout {
                    spacing: 18px;
                    LineEdit {
                        width: 360px;
                        text <=> root.domain-input;
                        placeholder-text: "Enter a target domain";
                        enabled: !root.scan-in-progress;
                        background: #ffffff12;
                        border-width: 1px;
                        border-color: #ffffff2a;
                        border-radius: 18px;
                        placeholder-text-color: #9aa7ff;
                        text-color: #f5f7ff;
                        font-size: 14px;
                    }
                    Button {
                        text: root.scan-in-progress ? "Scanning..." : "Launch Scan";
                        enabled: !root.scan-in-progress;
                        background: @linear-gradient(120deg, #5d80ff, #41d3ff);
                        border-width: 0px;
                        border-radius: 20px;
                        text-color: #0b1124;
                        font-weight: 600;
                        drop-shadow-color: #04112f99;
                        drop-shadow-blur: 24px;
                        drop-shadow-offset: 0px;
                        clicked => { root.start-scan(root.domain-input); }
                    }
                    ProgressIndicator {
                        visible: root.scan-in-progress;
                        indeterminate: root.scan-in-progress;
                        progress: root.scan-progress;
                    }
                    Button {
                        text: "Download Compliance Report";
                        enabled: root.report-available && !root.scan-in-progress;
                        background: @linear-gradient(130deg, #ffffff2e, #ffffff08);
                        border-width: 1px;
                        border-color: #ffffff3a;
                        border-radius: 20px;
                        text-color: #e2e9ff;
                        drop-shadow-color: #04081466;
                        drop-shadow-blur: 20px;
                        drop-shadow-offset: 0px;
                        clicked => { root.download-compliance-report(); }
                    }
                    Rectangle {
                        horizontal-stretch: 1;
                        opacity: 0;
                    }
                    VerticalLayout {
                        spacing: 4px;
                        alignment: center;
                        Text {
                            text: "Last Run";
                            font-size: 12px;
                            color: #9aa8ff;
                        }
                        Text {
                            text: root.last-run;
                            font-size: 16px;
                            color: #ffffff;
                        }
                    }
                }
                Text {
                    text: root.status-text;
                    color: root.status-color;
                    font-size: 16px;
                }
            }
        }

        HorizontalLayout {
            spacing: 18px;
            width: parent.width;
            for card[idx] in root.stats : Rectangle {
                width: parent.width / 4;
                background: @linear-gradient(155deg, #20284acc, #0f1327c8);
                border-radius: 22px;
                border-width: 1px;
                border-color: #ffffff14;
                padding: 20px;
                drop-shadow-color: #04081470;
                drop-shadow-blur: 28px;
                drop-shadow-offset: 0px;
                clip: true;
                VerticalLayout {
                    spacing: 6px;
                    Text {
                        text: card.title;
                        color: #7f8cff;
                        font-size: 14px;
                    }
                    Text {
                        text: card.value;
                        color: #ffffff;
                        font-size: 30px;
                        font-weight: 600;
                    }
                    Text {
                        text: card.subtitle;
                        color: #9ca9ff;
                        font-size: 12px;
                    }
                }
            }
        }

        HorizontalLayout {
            spacing: 18px;
            Rectangle {
                background: @linear-gradient(160deg, #1d2445cc, #111731c5);
                border-radius: 24px;
                border-width: 1px;
                border-color: #ffffff14;
                padding: 24px;
                drop-shadow-color: #0409156a;
                drop-shadow-blur: 34px;
                drop-shadow-offset: 0px;
                clip: true;
                width: parent.width * 0.6;
                VerticalLayout {
                    spacing: 12px;
                    Text {
                        text: "Live Service Activity";
                        font-size: 18px;
                        color: #ffffff;
                    }
                    HorizontalLayout {
                        spacing: 14px;
                        alignment: end;
                        for point[idx] in root.activity : VerticalLayout {
                            spacing: 8px;
                            alignment: center;
                            Rectangle {
                                border-radius: 12px;
                                width: 22px;
                                height: 12px + point.value * 108px;
                                background: @linear-gradient(180deg, #5a7cff, #45d5ff);
                            }
                            Text {
                                text: point.label;
                                font-size: 11px;
                                color: #b8c5ff;
                                horizontal-alignment: center;
                            }
                        }
                    }
                }
            }
            Rectangle {
                background: @linear-gradient(160deg, #1f264acc, #0f152fc8);
                border-radius: 24px;
                border-width: 1px;
                border-color: #ffffff1a;
                padding: 24px;
                drop-shadow-color: #04081470;
                drop-shadow-blur: 34px;
                drop-shadow-offset: 0px;
                clip: true;
                width: parent.width * 0.4;
                VerticalLayout {
                    spacing: 12px;
                    Text {
                        text: "Risk Alerts";
                        font-size: 18px;
                        color: #ffffff;
                    }
                    VerticalLayout {
                        spacing: 10px;
                        for alert[idx] in root.alerts : Rectangle {
                            background: @linear-gradient(140deg, alert.accent, #ffffff26);
                            border-radius: 18px;
                            border-width: 1px;
                            border-color: #ffffff36;
                            padding: 14px;
                            opacity: 0.82;
                            drop-shadow-color: #04081460;
                            drop-shadow-blur: 26px;
                            drop-shadow-offset: 0px;
                            clip: true;
                            VerticalLayout {
                                spacing: 4px;
                                Text {
                                    text: alert.label;
                                    font-size: 14px;
                                    color: #10142a;
                                }
                                Text {
                                    text: alert.count;
                                    font-size: 22px;
                                    color: #020305;
                                    font-weight: 600;
                                }
                            }
                        }
                    }
                }
            }
        }

        HorizontalLayout {
            spacing: 18px;
            Rectangle {
                background: @linear-gradient(160deg, #1b2242cc, #101630c8);
                border-radius: 24px;
                border-width: 1px;
                border-color: #ffffff14;
                padding: 24px;
                drop-shadow-color: #04091568;
                drop-shadow-blur: 34px;
                drop-shadow-offset: 0px;
                clip: true;
                width: parent.width * 0.6;
                VerticalLayout {
                    spacing: 12px;
                    Text {
                        text: "Live Subdomains";
                        font-size: 18px;
                        color: #ffffff;
                    }
                    ListView {
                        for row[idx] in root.subdomains : Rectangle {
                            background: row.highlight ? @linear-gradient(110deg, #2d3b6fd0, #18213dcf) : #101730c2;
                            border-radius: 16px;
                            border-width: 1px;
                            border-color: row.highlight ? #74f3ff40 : #ffffff12;
                            padding: 14px;
                            drop-shadow-color: row.highlight ? #1a2d5a7a : #05091555;
                            drop-shadow-blur: 22px;
                            drop-shadow-offset: 0px;
                            clip: true;
                            HorizontalLayout {
                                spacing: 12px;
                                Text {
                                    text: row.name;
                                    color: #ffffff;
                                    font-size: 14px;
                                }
                                Rectangle {
                                    horizontal-stretch: 1;
                                    opacity: 0;
                                }
                                Text {
                                    text: row.status;
                                    color: row.highlight ? #89f9ff : #9fb0ff;
                                    font-size: 13px;
                                }
                            }
                        }
                    }
                }
            }
            Rectangle {
                background: @linear-gradient(160deg, #20274dcc, #101630c8);
                border-radius: 24px;
                border-width: 1px;
                border-color: #ffffff18;
                padding: 24px;
                drop-shadow-color: #0409156f;
                drop-shadow-blur: 34px;
                drop-shadow-offset: 0px;
                clip: true;
                width: parent.width * 0.4;
                VerticalLayout {
                    spacing: 12px;
                    Text {
                        text: "Execution Timeline";
                        font-size: 18px;
                        color: #ffffff;
                    }
                    Text {
                        text: root.status-text;
                        font-size: 14px;
                        color: #9fb0ff;
                    }
                    Rectangle {
                        height: 1px;
                        background: #283059;
                        opacity: 0.8;
                    }
                    Text {
                        text: "Continuous Feature Monitoring";
                        font-size: 14px;
                        color: #c7d3ff;
                    }
                    ListView {
                        for feedback[idx] in root.feature-feedback : Rectangle {
                            background: @linear-gradient(150deg, #242c52cc, #151c3ac7);
                            border-radius: 16px;
                            border-width: 1px;
                            border-color: #ffffff12;
                            padding: 12px;
                            drop-shadow-color: #04091555;
                            drop-shadow-blur: 22px;
                            drop-shadow-offset: 0px;
                            clip: true;
                            VerticalLayout {
                                spacing: 4px;
                                Text {
                                    text: feedback.title;
                                    font-size: 13px;
                                    color: #f5f7ff;
                                }
                                Text {
                                    text: feedback.detail;
                                    font-size: 12px;
                                    color: #9fb0ff;
                                }
                            }
                        }
                    }
                }
            }
        }

        Rectangle {
            height: 12px;
            border-radius: 14px;
            background: #0d1328cc;
            border-width: 1px;
            border-color: #ffffff18;
            drop-shadow-color: #03071280;
            drop-shadow-blur: 30px;
            drop-shadow-offset: 0px;
            Rectangle {
                width: root.scan-progress * parent.width;
                height: parent.height;
                border-radius: parent.border-radius;
                background: @linear-gradient(90deg, #6c85ff, #42d9ff);
            }
        }
    }
}
}
